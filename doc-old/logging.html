<html>

<head>

  <meta name="author" content="Andy Seaborne"/>
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <meta http-equiv="Content-Language" content="en-gb">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

  <meta name="DC.Creator"    content="Andy Seaborne">
  <meta name="DC.Publisher"  content="">
  <meta name="DC.Title"      content="Joseki: RDF WebAPI">
  <meta name="DC.Rights"
        content="Copyright 2003, 2004, 2005 Hewlett-Packard Development Company LP">
  <meta name="DC.Identifier"
        content="http://www.joseki.org/logging.html">
  <meta name="DC.Format"     content="text/html; charset=iso-8859-1">
  <meta name="DC.Date"       content="$Date: 2005-06-26 18:39:02 $">
  <meta name="DC.Type"       content="web page">

<title>Joseki: Logging</title>
<link rel="stylesheet" type="text/css" href="StyleSheets/joseki.css">
</head>

<body>

<h1>Logging in the Joseki Server</h1>

<p>
This document describes the use of logging with a Joseki server.
It covers information for both people configuring and deploying a server
as well as those writing <A HREF="processors.html">query processors</A> and other
<A HREF="modules.html">modules</A>.
</p>

<p>
Joseki uses the <A HREF="http://jakarta.apache.org/commons/logging.html">
Jakarta Common Logging</A> package.  This is an API for code to be independent of the choice of logging environment.  Supported environments include
<a href="http://jakarta.apache.org/log4j/">Log4j</a> and java logging
introduced in Java 1.4.
</p>
<p>Early versions of Joseki (up to v2.0) just used Java logging &ndash;  more
convenient use in Tomcat prompted the change to Jakarta Commons Logging.
<a href="http://jena.sourceforge.net/">Jena</a> also uses Jakarta Commons 
Logging.</p>




<h2>Logging Policy</h2>

<p>This is just applying the general logging recommendations found in the <a href="http://jakarta.apache.org/commons/logging/userguide.html">Jakarta Commons Logging user guide</a>.</p>

<p align="center">
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 width="90%">
<TR VALIGN="middle">
	<TH width="20%">Level</TH>
	<TH width="80%">Usage</TH>
</TR>
<TRVALIGN="middle">
	<TD>trace</TD>
	<TD style="text-align: left">The lowest level: can be very verbose.</TD>
</TR>
<TRVALIGN="middle">
	<TD>debug</TD>
	<TD style="text-align: left">Detailed information about the configuration of the server and
	    execution of requests.  Normally disabled but enabled for tracking
	    down problems with a server.</TD>
</TR>
<TRVALIGN="middle">
	<TD>info</TD>
	<TD style="text-align: left">Normally a server will run with this level enabled.  It is used to record,
	briefly, configuration and all requests, roughtly one logging entry per
	successful request, or one logging entry for a failed request.
	</TD>
</TR>
<TRVALIGN="middle">
	<TD>warn</TD>
	<TD style="text-align: left">Used to note server problems which do not stop the request from proceeding.
	This is not the same as a failed request.  They get logged as .info</TD>
</TR>
<TRVALIGN="middle">
	<TD>error</TD>
	<TD style="text-align: left">Used to record (internal) problems that stop the request being processed or when
	internal inconsistences are deteched.  The server may be able to continue processing
	some requests (e.g. on other models).
	</TD>
</TR>
<TRVALIGN="middle">
	<TD>fatal</TD>
	<TD style="text-align: left">A problem has arisen that causes the whole server to cease functioning correctly.</TD>
</TR>
</TABLE>
</p>




<h2>Notes</h2>




<h3>Logging in the standalone server</h3>

<p>Joseki defaults to using log4j because Joseki comes with a copy of log4j and 
standard way Jakarta Commons Logging decides which logging system to use is 
first to check for log4j.&nbsp; You can choose the logging implementation you want by setting the system 
property <code>org.apache.commons.logging.Log</code></p>

<ul>
  <li>Java logging: <code>org.apache.commons.logging.impl.Jdk14Logger</code></li>
  <li>Log4j: <code>org.apache.commons.logging.impl.Log4JLogger</code> </li>
</ul>




<p>Some sample logging configurations are given in the <code>etc/</code> 
directory.</p>




<h3>Logging in Tomcat</h3>

<ul>
  <li>Tomcat uses Jakarta Commons Logging. If you want to use log4j with Tomcat, you can 
  just drop in the log4j jar.&nbsp; If a web application, like Joseki, has 
  its own private copy as well, this will create its own initialization of log4j 
  just for that web application. </li>
  <li>To set the configuration file, either place <code>log4j.properties</code> 
  on the classpath (it is not found as a file), such as in <code>
  WEB-INF/classes/log4j.properties</code> or set the system property when 
  starting Tomcat:<br>
  <code>export CATALINA_OPTS=&quot;-Dlog4j.configuration=file:&lt;your config file&gt;&quot;</code></li>
</ul>




<h3>Log4j</h3>




<p>Levels <code>trace</code> and <code>debug</code> are both mapped to log4j 
level <code>DEBUG</code>.&nbsp; Example log4j property files are to be found in
<code>etc/</code>.</p>




<h3>Java Logging</h3>




<p>There is a stream handler that writes to stdout, and then always flushes 
messages and also a one line formatter (it formats messages to be like the form 
for the one line log4j PatternLayout used intge log4j examples) in the package
<code>org.joseki.logging.java</code>. Example logging property files are to be 
found in <code>etc/</code>.</p>




<h2>Module Implementers</h2>

<p>Implementers of Joseki <a href="modules.html">modules</a> should read the
<a href="http://jakarta.apache.org/commons/logging/userguide.html">Jakarta Commons Logging user guide</a> 
and folow the guidelines on levels.&nbsp; They are only guidelines - just 
remember your module may be running inside a large system so don't output too much 
by default.&nbsp; The server will log once per request.&nbsp; It is a judgement call.
</p>

</body>
</html>